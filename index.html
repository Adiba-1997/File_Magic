<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy File Conversion - Convert Any File Format</title>
    
    <!-- AdSense Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2756415731978402" crossorigin="anonymous"></script>
    
    <!-- Required Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.16.0/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/compressorjs/1.1.1/compressor.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.4.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Fonts and Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --accent: #fd79a8;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #00b894;
            --info: #0984e3;
            --warning: #fdcb6e;
            --danger: #d63031;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            color: var(--dark);
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 3fr 1fr;
            gap: 20px;
        }
        
        .main-content {
            grid-column: 2;
        }
        
        .ad-sidebar {
            margin-top: 100px;
            position: sticky;
            top: 20px;
            height: fit-content;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            grid-column: 1 / -1;
        }
        
        h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tagline {
            font-size: 1.2rem;
            color: var(--dark);
            margin-bottom: 20px;
        }
        
        .tool-name {
            font-weight: 700;
            color: #6c5ce7;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .converter-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .converter-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s, box-shadow 0.3s;
            cursor: pointer;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }
        
        .converter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 1);
        }
        
        .converter-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .converter-card h3 {
            margin-bottom: 10px;
            color: var(--dark);
            font-weight: 600;
        }
        
        .converter-card p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .file-input-container {
            display: none;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }
        
        .file-input-container.active {
            display: block;
        }
        
        .file-input-wrapper {
            border: 2px dashed var(--secondary);
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: background 0.3s;
            background: rgba(255, 255, 255, 0.5);
        }
        
        .file-input-wrapper:hover {
            background: rgba(162, 155, 254, 0.2);
        }
        
        .file-input-wrapper i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .file-input-wrapper p {
            margin-bottom: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #5649c0, #8c83d8);
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #a29bfe, #c8c4f5);
            color: white;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(45deg, #8c83d8, #b5b0e8);
            box-shadow: 0 5px 15px rgba(162, 155, 254, 0.4);
        }
        
        .options-container {
            margin-top: 20px;
            display: none;
        }
        
        .options-container.active {
            display: block;
        }
        
        .option-group {
            margin-bottom: 15px;
        }
        
        .option-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .option-group input, .option-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .progress-container {
            display: none;
            margin-top: 20px;
        }
        
        .progress-bar {
            height: 10px;
            background: #eee;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(45deg, #00b894, #55efc4);
            width: 0%;
            transition: width 0.3s;
        }
        
        .result-container {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        
        .result-container a {
            display: inline-block;
            margin-top: 15px;
        }
        
        .ad-container {
            margin: 30px 0;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .ad-bottom {
            grid-column: 1 / -1;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 50px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            grid-column: 1 / -1;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: white;
            font-weight: 500;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .tab.active {
            border-bottom: 3px solid white;
            color: white;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Image Editor Modal */
        .editor-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .editor-modal.active {
            display: flex;
        }
        
        .editor-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: auto;
        }
        
        .editor-tools {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .editor-tool-btn {
            padding: 8px 12px;
            background: #6c5ce7;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .editor-canvas-container {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        #editor-canvas {
            max-width: 100%;
            max-height: 60vh;
            border: 1px solid #ddd;
        }
        
        .editor-range {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .editor-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Content Sections for AdSense Compliance */
        .content-section {
            background: rgba(255, 255, 255, 0.85);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .content-section h3 {
            color: var(--primary);
            margin-bottom: 15px;
            border-bottom: 1px solid var(--secondary);
            padding-bottom: 8px;
        }
        
        .content-section ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        
        .content-section li {
            margin-bottom: 8px;
        }
        
        .format-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }
        
        .faq-item {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--secondary);
        }
        
        .faq-item h4 {
            color: var(--dark);
            margin-bottom: 8px;
        }
        
        .ad-wrapper {
            margin: 25px 0;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .main-content {
                grid-column: 1;
            }
            
            .ad-sidebar {
                display: none;
            }
            
            .converter-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .format-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Left Sidebar with Content and Ad -->
        <div class="ad-sidebar">
            <div class="content-section">
                <h3>About Our File Converter</h3>
                <p>Our free online tools help you convert between document formats quickly and securely. All processing happens in your browser - we never upload your files to our servers.</p>
                
                <h4>Popular Conversions</h4>
                <ul>
                    <li>Word to PDF (DOC/DOCX → PDF)</li>
                    <li>PDF to Word (PDF → DOCX)</li>
                    <li>Excel to PDF (XLS/XLSX → PDF)</li>
                    <li>Image to PDF (JPG/PNG → PDF)</li>
                    <li>PDF to JPG (PDF → Image)</li>
                </ul>
            </div>
            
            <!-- Left Sidebar Ad -->
            <div class="ad-wrapper">
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-2756415731978402"
                    data-ad-slot="REPLACE_WITH_LEFT_SIDEBAR_SLOT_ID"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                <script>
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.error("AdSense error:", e);
                    }
                </script>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <header>
                <h1><i class="fas fa-magic"></i> <span class="tool-name">Easy File Conversion</span></h1>
                <p class="tagline">Convert any file format with ease - <span class="tool-name">100% free!</span></p>
                
                <div class="content-section">
                    <h3>Welcome to Your File Conversion Solution</h3>
                    <p>Our online file converter provides fast, secure conversion between all popular document formats. Unlike other services, we process your files directly in your browser.</p>
                    
                    <div class="format-grid">
                        <div>
                            <h4>How It Works:</h4>
                            <ol>
                                <li>Select the conversion tool you need</li>
                                <li>Upload your file (or drag & drop)</li>
                                <li>Download your converted file</li>
                            </ol>
                        </div>
                        <div>
                            <h4>Key Benefits:</h4>
                            <ul>
                                <li>Complete privacy - your files stay on your device</li>
                                <li>No registration or sign-up required</li>
                                <li>No watermarks added to your documents</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main Content Ad 1 -->
            <div class="ad-wrapper">
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-2756415731978402"
                    data-ad-slot="REPLACE_WITH_MAIN_CONTENT_SLOT_ID"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                <script>
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.error("AdSense error:", e);
                    }
                </script>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="word">Word Tools</div>
                <div class="tab" data-tab="pdf">PDF Tools</div>
                <div class="tab" data-tab="image">Image Tools</div>
                <div class="tab" data-tab="presentation">Presentations</div>
            </div>
            
            <!-- Word Tools Tab -->
            <div class="tab-content active" id="word-tab">
                <div class="converter-container">
                    <div class="converter-card" data-converter="word-to-pdf">
                        <i class="fas fa-file-word"></i>
                        <h3>Word to PDF</h3>
                        <p>Convert DOC/DOCX files to PDF format</p>
                    </div>
                    <div class="converter-card" data-converter="word-to-excel">
                        <i class="fas fa-file-excel"></i>
                        <h3>Word to Excel</h3>
                        <p>Convert Word tables to Excel spreadsheets</p>
                    </div>
                    <div class="converter-card" data-converter="word-to-image">
                        <i class="fas fa-image"></i>
                        <h3>Word to Image</h3>
                        <p>Convert Word documents to image files</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-to-word">
                        <i class="fas fa-file-pdf"></i>
                        <h3>PDF to Word</h3>
                        <p>Convert PDF files to editable Word documents</p>
                    </div>
                    <div class="converter-card" data-converter="image-to-word">
                        <i class="fas fa-file-word"></i>
                        <h3>Image to Word</h3>
                        <p>Convert images with text to Word documents</p>
                    </div>
                </div>
            </div>
            
            <!-- PDF Tools Tab -->
            <div class="tab-content" id="pdf-tab">
                <div class="converter-container">
                    <div class="converter-card" data-converter="pdf-edit">
                        <i class="fas fa-edit"></i>
                        <h3>PDF Edit</h3>
                        <p>Edit text and images in PDF files</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-merge">
                        <i class="fas fa-object-group"></i>
                        <h3>PDF Merge</h3>
                        <p>Combine multiple PDFs into one</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-compress">
                        <i class="fas fa-compress-alt"></i>
                        <h3>PDF Compress</h3>
                        <p>Reduce PDF file size</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-split">
                        <i class="fas fa-cut"></i>
                        <h3>PDF Split</h3>
                        <p>Split PDF into multiple files</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-repair">
                        <i class="fas fa-tools"></i>
                        <h3>PDF Repair</h3>
                        <p>Fix corrupted PDF files</p>
                    </div>
                    <div class="converter-card" data-converter="image-to-pdf">
                        <i class="fas fa-file-pdf"></i>
                        <h3>Image to PDF</h3>
                        <p>Convert images to PDF documents</p>
                    </div>
                </div>
            </div>
            
            <!-- Image Tools Tab -->
            <div class="tab-content" id="image-tab">
                <div class="converter-container">
                    <div class="converter-card" data-converter="image-compression">
                        <i class="fas fa-compress-alt"></i>
                        <h3>Image Compression</h3>
                        <p>Reduce image file size</p>
                    </div>
                    <div class="converter-card" data-converter="image-merge">
                        <i class="fas fa-object-group"></i>
                        <h3>Image Merge</h3>
                        <p>Combine multiple images into one</p>
                    </div>
                    <div class="converter-card" data-converter="image-editor">
                        <i class="fas fa-edit"></i>
                        <h3>Image Editor</h3>
                        <p>Edit and enhance your images</p>
                    </div>
                    <div class="converter-card" data-converter="image-split">
                        <i class="fas fa-cut"></i>
                        <h3>Image Split</h3>
                        <p>Split images into multiple parts</p>
                    </div>
                </div>
            </div>
            
            <!-- Presentation Tools Tab -->
            <div class="tab-content" id="presentation-tab">
                <div class="converter-container">
                    <div class="converter-card" data-converter="word-to-ppt">
                        <i class="fas fa-file-powerpoint"></i>
                        <h3>Word to PPT</h3>
                        <p>Convert Word documents to PowerPoint</p>
                    </div>
                    <div class="converter-card" data-converter="ppt-to-word">
                        <i class="fas fa-file-word"></i>
                        <h3>PPT to Word</h3>
                        <p>Convert PowerPoint to Word documents</p>
                    </div>
                    <div class="converter-card" data-converter="ppt-to-pdf">
                        <i class="fas fa-file-pdf"></i>
                        <h3>PPT to PDF</h3>
                        <p>Convert PowerPoint to PDF</p>
                    </div>
                    <div class="converter-card" data-converter="pdf-to-ppt">
                        <i class="fas fa-file-powerpoint"></i>
                        <h3>PDF to PPT</h3>
                        <p>Convert PDF to PowerPoint</p>
                    </div>
                </div>
            </div>
            
            <!-- File Input UI -->
            <div class="file-input-container" id="converter-ui">
                <h2 id="converter-title">Convert File</h2>
                <div class="file-input-wrapper" id="file-drop-area">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p id="file-instructions">Drag & drop your file here or click to browse</p>
                    <p class="file-types" id="supported-formats">Supported formats: </p>
                    <input type="file" id="file-input" style="display: none;">
                </div>
                
                <div class="options-container" id="conversion-options">
                    <!-- Options will be dynamically inserted here -->
                </div>
                
                <div class="progress-container" id="progress-container">
                    <p>Processing your file...</p>
                    <div class="progress-bar">
                        <div class="progress" id="progress-bar"></div>
                    </div>
                    <p id="progress-text">0%</p>
                </div>
                
                <div class="result-container" id="result-container">
                    <h3>Conversion Complete!</h3>
                    <p>Your file has been successfully converted.</p>
                    <a href="#" class="btn btn-primary" id="download-btn">Download File</a>
                    <button class="btn btn-secondary" id="new-conversion">New Conversion</button>
                </div>
                
                <button class="btn btn-primary" id="convert-btn" style="display: none;">Convert</button>
            </div>
            
            <!-- More Content Sections -->
            <div class="content-section">
                <h3>Supported File Formats</h3>
                <p>We support conversion between all major document, image, and presentation formats:</p>
                
                <div class="format-grid">
                    <div>
                        <h4>Document Formats</h4>
                        <ul>
                            <li>Microsoft Word (DOC, DOCX)</li>
                            <li>PDF (Portable Document Format)</li>
                            <li>Rich Text Format (RTF)</li>
                            <li>Plain Text (TXT)</li>
                        </ul>
                    </div>
                    <div>
                        <h4>Spreadsheet Formats</h4>
                        <ul>
                            <li>Microsoft Excel (XLS, XLSX)</li>
                            <li>Comma Separated Values (CSV)</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Main Content Ad 2 -->
            <div class="ad-wrapper">
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-2756415731978402"
                    data-ad-slot="REPLACE_WITH_SECOND_MAIN_SLOT_ID"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                <script>
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.error("AdSense error:", e);
                    }
                </script>
            </div>
            
            <div class="content-section">
                <h3>Frequently Asked Questions</h3>
                
                <div class="faq-item">
                    <h4>Is this service really free?</h4>
                    <p>Yes! All our conversion tools are completely free to use with no hidden charges.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Are my files secure?</h4>
                    <p>Absolutely. We process all files directly in your browser. Your documents never leave your computer.</p>
                </div>
            </div>
        </div>
        
        <!-- Right Sidebar with Content and Ad -->
        <div class="ad-sidebar">
            <div class="content-section">
                <h3>Conversion Tips & Tricks</h3>
                
                <h4>For Best Results:</h4>
                <ul>
                    <li>Use text-based PDFs rather than scanned documents</li>
                    <li>Complex formatting may not convert perfectly</li>
                    <li>For large files, consider splitting them</li>
                </ul>
            </div>
            
            <!-- Right Sidebar Ad -->
            <div class="ad-wrapper">
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-2756415731978402"
                    data-ad-slot="REPLACE_WITH_RIGHT_SIDEBAR_SLOT_ID"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                <script>
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.error("AdSense error:", e);
                    }
                </script>
            </div>
        </div>
        
        <!-- Bottom Ad with Content -->
        <div class="ad-container ad-bottom">
            <div class="content-section">
                <h3>About Our Service</h3>
                <p>We've been providing free online file conversion tools since 2020. Our mission is to make document conversion accessible to everyone.</p>
            </div>
            
            <div class="ad-wrapper">
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-2756415731978402"
                    data-ad-slot="REPLACE_WITH_BOTTOM_SLOT_ID"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                <script>
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.error("AdSense error:", e);
                    }
                </script>
            </div>
        </div>
        
        <footer>
            <div class="content-section">
                <p>&copy; 2025 <span class="tool-name">Easy File Conversion</span> - Free Online File Converter</p>
                <p>All conversions are performed in your browser - your files are never uploaded to our servers</p>
            </div>
        </footer>
    </div>

    <!-- Image Editor Modal -->
    <div class="editor-modal" id="image-editor-modal">
        <div class="editor-container">
            <h2>Image Editor</h2>
            <div class="editor-tools">
                <button class="editor-tool-btn" id="brightness-btn">Brightness</button>
                <button class="editor-tool-btn" id="contrast-btn">Contrast</button>
                <button class="editor-tool-btn" id="saturation-btn">Saturation</button>
                <button class="editor-tool-btn" id="grayscale-btn">Grayscale</button>
                <button class="editor-tool-btn" id="sepia-btn">Sepia</button>
                <button class="editor-tool-btn" id="reset-btn">Reset</button>
            </div>
            
            <div class="editor-canvas-container">
                <canvas id="editor-canvas"></canvas>
            </div>
            
            <input type="range" id="editor-range" class="editor-range" min="-100" max="100" value="0">
            
            <div class="editor-actions">
                <button class="btn btn-secondary" id="cancel-edit">Cancel</button>
                <button class="btn btn-primary" id="apply-edit">Apply</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentConverter = null;
        let currentFile = null;
        const { jsPDF } = window.jspdf;
        
        // Image Editor variables
        let editorCanvas = document.getElementById('editor-canvas');
        let editorCtx = editorCanvas.getContext('2d');
        let originalImageData = null;
        let currentFilter = null;
        
        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
            });
        });
        
        // Converter card functionality
        document.querySelectorAll('.converter-card').forEach(card => {
            card.addEventListener('click', () => {
                currentConverter = card.dataset.converter;
                document.getElementById('converter-ui').classList.add('active');
                document.getElementById('file-input').value = '';
                document.getElementById('result-container').style.display = 'none';
                document.getElementById('progress-container').style.display = 'none';
                document.getElementById('convert-btn').style.display = 'none';
                
                // Set converter title
                document.getElementById('converter-title').textContent = card.querySelector('h3').textContent;
                
                // Set supported formats
                let formats = '';
                switch(currentConverter) {
                    case 'word-to-pdf':
                    case 'pdf-to-word':
                    case 'word-to-excel':
                    case 'word-to-image':
                    case 'image-to-word':
                        formats = 'DOC, DOCX';
                        break;
                    case 'pdf-edit':
                    case 'pdf-merge':
                    case 'pdf-compress':
                    case 'pdf-split':
                    case 'pdf-repair':
                    case 'image-to-pdf':
                        formats = 'PDF';
                        break;
                    case 'image-compression':
                    case 'image-merge':
                    case 'image-editor':
                    case 'image-split':
                        formats = 'JPG, PNG, GIF, BMP';
                        break;
                    case 'word-to-ppt':
                    case 'ppt-to-word':
                    case 'ppt-to-pdf':
                    case 'pdf-to-ppt':
                        formats = 'PPT, PPTX';
                        break;
                }
                
                if (currentConverter === 'pdf-merge' || currentConverter === 'image-merge') {
                    document.getElementById('file-instructions').textContent = 'Drag & drop multiple files here or click to browse';
                    document.getElementById('file-input').setAttribute('multiple', '');
                } else {
                    document.getElementById('file-instructions').textContent = 'Drag & drop your file here or click to browse';
                    document.getElementById('file-input').removeAttribute('multiple');
                }
                
                document.getElementById('supported-formats').textContent = `Supported formats: ${formats}`;
                
                // Set options
                const optionsContainer = document.getElementById('conversion-options');
                optionsContainer.innerHTML = '';
                optionsContainer.classList.remove('active');
                
                // Scroll to converter UI
                document.getElementById('converter-ui').scrollIntoView({ behavior: 'smooth' });
            });
        });
        
        // File input functionality
        document.getElementById('file-drop-area').addEventListener('click', () => {
            document.getElementById('file-input').click();
        });
        
        document.getElementById('file-input').addEventListener('change', handleFileSelect);
        
        // Drag and drop functionality
        const fileDropArea = document.getElementById('file-drop-area');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            fileDropArea.style.borderColor = 'var(--primary)';
            fileDropArea.style.backgroundColor = 'rgba(162, 155, 254, 0.1)';
        }
        
        function unhighlight() {
            fileDropArea.style.borderColor = 'var(--secondary)';
            fileDropArea.style.backgroundColor = '';
        }
        
        fileDropArea.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                handleFiles(files);
            }
        }
        
        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                handleFiles(files);
            }
        }
        
        function handleFiles(files) {
            if (currentConverter === null) return;
            
            // For merge operations, we handle multiple files
            if ((currentConverter === 'pdf-merge' || currentConverter === 'image-merge') && files.length > 1) {
                currentFile = files;
                prepareForConversion();
                return;
            }
            
            // For other operations, we only handle the first file
            currentFile = files[0];
            prepareForConversion();
        }
        
        function prepareForConversion() {
            document.getElementById('convert-btn').style.display = 'block';
            
            // Show file info
            if (currentFile instanceof FileList || Array.isArray(currentFile)) {
                document.getElementById('file-instructions').textContent = `${currentFile.length} files selected`;
            } else {
                document.getElementById('file-instructions').textContent = currentFile.name;
            }
            
            // Show options if available
            const optionsContainer = document.getElementById('conversion-options');
            optionsContainer.innerHTML = '';
            
            switch(currentConverter) {
                case 'pdf-compress':
                    optionsContainer.innerHTML = `
                        <div class="option-group">
                            <label for="compression-level">Compression Level</label>
                            <select id="compression-level">
                                <option value="low">Low (Smaller size reduction, better quality)</option>
                                <option value="medium" selected>Medium (Balance between size and quality)</option>
                                <option value="high">High (Maximum size reduction, lower quality)</option>
                            </select>
                        </div>
                    `;
                    break;
                    
                case 'pdf-split':
                    optionsContainer.innerHTML = `
                        <div class="option-group">
                            <label for="split-method">Split Method</label>
                            <select id="split-method">
                                <option value="range">Split by page range</option>
                                <option value="every">Split every X pages</option>
                            </select>
                        </div>
                        <div class="option-group" id="range-options">
                            <label for="page-range">Page Range (e.g., 1-3,5,7-10)</label>
                            <input type="text" id="page-range" placeholder="1-3,5,7-10">
                        </div>
                        <div class="option-group" id="every-options" style="display: none;">
                            <label for="every-pages">Split every X pages</label>
                            <input type="number" id="every-pages" min="1" value="1">
                        </div>
                    `;
                    
                    document.getElementById('split-method').addEventListener('change', function() {
                        document.getElementById('range-options').style.display = 
                            this.value === 'range' ? 'block' : 'none';
                        document.getElementById('every-options').style.display = 
                            this.value === 'every' ? 'block' : 'none';
                    });
                    break;
                    
                case 'image-compression':
                    optionsContainer.innerHTML = `
                        <div class="option-group">
                            <label for="image-quality">Image Quality (0-100)</label>
                            <input type="range" id="image-quality" min="0" max="100" value="80">
                            <span id="quality-value">80%</span>
                        </div>
                        <div class="option-group">
                            <label for="image-width">Resize Width (px, 0 to keep original)</label>
                            <input type="number" id="image-width" min="0" value="0">
                        </div>
                        <div class="option-group">
                            <label for="image-height">Resize Height (px, 0 to keep original)</label>
                            <input type="number" id="image-height" min="0" value="0">
                        </div>
                    `;
                    
                    document.getElementById('image-quality').addEventListener('input', function() {
                        document.getElementById('quality-value').textContent = `${this.value}%`;
                    });
                    break;
                    
                case 'image-merge':
                    optionsContainer.innerHTML = `
                        <div class="option-group">
                            <label for="merge-direction">Merge Direction</label>
                            <select id="merge-direction">
                                <option value="vertical">Vertical (Top to Bottom)</option>
                                <option value="horizontal">Horizontal (Left to Right)</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label for="merge-spacing">Spacing Between Images (px)</label>
                            <input type="number" id="merge-spacing" min="0" value="0">
                        </div>
                        <div class="option-group">
                            <label for="merge-background">Background Color</label>
                            <input type="color" id="merge-background" value="#ffffff">
                        </div>
                    `;
                    break;
            }
            
            if (optionsContainer.innerHTML !== '') {
                optionsContainer.classList.add('active');
            }
        }
        
        // Convert button functionality
        document.getElementById('convert-btn').addEventListener('click', startConversion);
        
        function startConversion() {
            if (!currentFile || !currentConverter) return;
            
            document.getElementById('convert-btn').style.display = 'none';
            document.getElementById('progress-container').style.display = 'block';
            document.getElementById('progress-bar').style.width = '0%';
            document.getElementById('progress-text').textContent = '0%';
            
            // Simulate progress for demonstration
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 5;
                if (progress > 100) progress = 100;
                document.getElementById('progress-bar').style.width = `${progress}%`;
                document.getElementById('progress-text').textContent = `${progress}%`;
                
                if (progress === 100) {
                    clearInterval(progressInterval);
                    performConversion();
                }
            }, 200);
        }
        
        async function performConversion() {
            try {
                let result;
                
                switch(currentConverter) {
                    case 'word-to-pdf':
                        result = await convertWordToPdf(currentFile);
                        break;
                    case 'word-to-excel':
                        result = await convertWordToExcel(currentFile);
                        break;
                    case 'word-to-image':
                        result = await convertWordToImage(currentFile);
                        break;
                    case 'pdf-to-word':
                        result = await convertPdfToWord(currentFile);
                        break;
                    case 'image-to-word':
                        result = await convertImageToWord(currentFile);
                        break;
                    case 'pdf-edit':
                        result = await editPdf(currentFile);
                        break;
                    case 'pdf-merge':
                        result = await mergePdfs(currentFile);
                        break;
                    case 'pdf-compress':
                        result = await compressPdf(currentFile);
                        break;
                    case 'pdf-split':
                        result = await splitPdf(currentFile);
                        break;
                    case 'pdf-repair':
                        result = await repairPdf(currentFile);
                        break;
                    case 'image-to-pdf':
                        result = await convertImageToPdf(currentFile);
                        break;
                    case 'image-compression':
                        result = await compressImage(currentFile);
                        break;
                    case 'image-merge':
                        result = await mergeImages(currentFile);
                        break;
                    case 'image-editor':
                        result = await editImage(currentFile);
                        break;
                    case 'image-split':
                        result = await splitImage(currentFile);
                        break;
                    case 'word-to-ppt':
                        result = await convertWordToPpt(currentFile);
                        break;
                    case 'ppt-to-word':
                        result = await convertPptToWord(currentFile);
                        break;
                    case 'ppt-to-pdf':
                        result = await convertPptToPdf(currentFile);
                        break;
                    case 'pdf-to-ppt':
                        result = await convertPdfToPpt(currentFile);
                        break;
                    default:
                        throw new Error('Unsupported conversion type');
                }
                
                showResult(result);
            } catch (error) {
                console.error('Conversion error:', error);
                alert(`Conversion failed: ${error.message}`);
                resetConverterUI();
            }
        }
        
        function showResult(result) {
            document.getElementById('progress-container').style.display = 'none';
            document.getElementById('result-container').style.display = 'block';
            
            const downloadBtn = document.getElementById('download-btn');
            downloadBtn.href = URL.createObjectURL(result.file);
            downloadBtn.download = result.filename;
            
            // Scroll to result
            document.getElementById('result-container').scrollIntoView({ behavior: 'smooth' });
        }
        
        // New conversion button
        document.getElementById('new-conversion').addEventListener('click', resetConverterUI);
        
        function resetConverterUI() {
            currentFile = null;
            document.getElementById('file-input').value = '';
            document.getElementById('file-instructions').textContent = 'Drag & drop your file here or click to browse';
            document.getElementById('result-container').style.display = 'none';
            document.getElementById('convert-btn').style.display = 'none';
            document.getElementById('conversion-options').classList.remove('active');
        }
        
        // Image Editor Functions
        async function editImage(file) {
            return new Promise((resolve) => {
                // Create image from file
                const img = new Image();
                const url = URL.createObjectURL(file);
                
                img.onload = function() {
                    // Set canvas dimensions
                    editorCanvas.width = img.width;
                    editorCanvas.height = img.height;
                    
                    // Draw image on canvas
                    editorCtx.drawImage(img, 0, 0);
                    
                    // Store original image data
                    originalImageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
                    
                    // Show editor modal
                    document.getElementById('image-editor-modal').classList.add('active');
                    
                    // Set up editor buttons
                    setupImageEditor(resolve, file.name);
                };
                
                img.src = url;
            });
        }
        
        function setupImageEditor(resolveCallback, originalFilename) {
            // Reset range slider
            document.getElementById('editor-range').value = 0;
            
            // Set up tool buttons
            document.getElementById('brightness-btn').onclick = () => {
                currentFilter = 'brightness';
                updateImageFilter();
            };
            
            document.getElementById('contrast-btn').onclick = () => {
                currentFilter = 'contrast';
                updateImageFilter();
            };
            
            document.getElementById('saturation-btn').onclick = () => {
                currentFilter = 'saturation';
                updateImageFilter();
            };
            
            document.getElementById('grayscale-btn').onclick = () => {
                currentFilter = 'grayscale';
                updateImageFilter();
            };
            
            document.getElementById('sepia-btn').onclick = () => {
                currentFilter = 'sepia';
                updateImageFilter();
            };
            
            document.getElementById('reset-btn').onclick = resetImage;
            
            // Set up range slider
            document.getElementById('editor-range').oninput = updateImageFilter;
            
            // Set up action buttons
            document.getElementById('cancel-edit').onclick = () => {
                document.getElementById('image-editor-modal').classList.remove('active');
                resolveCallback(null); // Return null to indicate cancellation
            };
            
            document.getElementById('apply-edit').onclick = () => {
                // Convert canvas to blob
                editorCanvas.toBlob((blob) => {
                    document.getElementById('image-editor-modal').classList.remove('active');
                    resolveCallback({
                        file: blob,
                        filename: 'edited_' + originalFilename
                    });
                }, 'image/jpeg', 0.9);
            };
        }
        
        function resetImage() {
            if (originalImageData) {
                editorCtx.putImageData(originalImageData, 0, 0);
                currentFilter = null;
                document.getElementById('editor-range').value = 0;
            }
        }
        
        function updateImageFilter() {
            if (!originalImageData) return;
            
            // Reset to original image
            editorCtx.putImageData(originalImageData, 0, 0);
            
            const value = parseInt(document.getElementById('editor-range').value);
            
            switch(currentFilter) {
                case 'brightness':
                    applyBrightness(value);
                    break;
                case 'contrast':
                    applyContrast(value);
                    break;
                case 'saturation':
                    applySaturation(value);
                    break;
                case 'grayscale':
                    applyGrayscale();
                    break;
                case 'sepia':
                    applySepia();
                    break;
            }
        }
        
        function applyBrightness(value) {
            const imageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
            const data = imageData.data;
            const factor = (value + 100) / 100;
            
            for (let i = 0; i < data.length; i += 4) {
                data[i] = data[i] * factor;     // R
                data[i + 1] = data[i + 1] * factor; // G
                data[i + 2] = data[i + 2] * factor; // B
            }
            
            editorCtx.putImageData(imageData, 0, 0);
        }
        
        function applyContrast(value) {
            const imageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
            const data = imageData.data;
            const factor = (value + 100) / 100;
            const intercept = 128 * (1 - factor);
            
            for (let i = 0; i < data.length; i += 4) {
                data[i] = data[i] * factor + intercept;     // R
                data[i + 1] = data[i + 1] * factor + intercept; // G
                data[i + 2] = data[i + 2] * factor + intercept; // B
            }
            
            editorCtx.putImageData(imageData, 0, 0);
        }
        
        function applySaturation(value) {
            const imageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
            const data = imageData.data;
            const factor = (value + 100) / 100;
            
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                const gray = 0.2989 * r + 0.5870 * g + 0.1140 * b; // Grayscale value
                
                data[i] = gray + (r - gray) * factor;     // R
                data[i + 1] = gray + (g - gray) * factor; // G
                data[i + 2] = gray + (b - gray) * factor; // B
            }
            
            editorCtx.putImageData(imageData, 0, 0);
        }
        
        function applyGrayscale() {
            const imageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                const avg = 0.2989 * data[i] + 0.5870 * data[i + 1] + 0.1140 * data[i + 2];
                data[i] = data[i + 1] = data[i + 2] = avg;
            }
            
            editorCtx.putImageData(imageData, 0, 0);
        }
        
        function applySepia() {
            const imageData = editorCtx.getImageData(0, 0, editorCanvas.width, editorCanvas.height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                data[i] = Math.min(255, (r * 0.393) + (g * 0.769) + (b * 0.189));
                data[i + 1] = Math.min(255, (r * 0.349) + (g * 0.686) + (b * 0.168));
                data[i + 2] = Math.min(255, (r * 0.272) + (g * 0.534) + (b * 0.131));
            }
            
            editorCtx.putImageData(imageData, 0, 0);
        }
        
        // Conversion Functions
        async function convertWordToPdf(file) {
            const arrayBuffer = await file.arrayBuffer();
            const result = await mammoth.convertToHtml({ arrayBuffer });
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = result.value;
            document.body.appendChild(tempDiv);
            
            const canvas = await html2canvas(tempDiv);
            document.body.removeChild(tempDiv);
            
            const pdf = new jsPDF();
            pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, pdf.internal.pageSize.getWidth(), pdf.internal.pageSize.getHeight());
            
            const pdfBlob = pdf.output('blob');
            return {
                file: pdfBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.pdf'
            };
        }
        
        async function convertWordToExcel(file) {
            const arrayBuffer = await file.arrayBuffer();
            const result = await mammoth.convertToHtml({ arrayBuffer });
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = result.value;
            const tables = tempDiv.querySelectorAll('table');
            
            if (tables.length === 0) {
                throw new Error('No tables found in the Word document');
            }
            
            const wb = XLSX.utils.book_new();
            
            tables.forEach((table, index) => {
                const ws = XLSX.utils.table_to_sheet(table);
                XLSX.utils.book_append_sheet(wb, ws, `Table ${index + 1}`);
            });
            
            const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            const excelBlob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            
            return {
                file: excelBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.xlsx'
            };
        }
        
        async function convertWordToImage(file) {
            const arrayBuffer = await file.arrayBuffer();
            const result = await mammoth.convertToHtml({ arrayBuffer });
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = result.value;
            document.body.appendChild(tempDiv);
            
            const canvas = await html2canvas(tempDiv);
            document.body.removeChild(tempDiv);
            
            return new Promise((resolve) => {
                canvas.toBlob((blob) => {
                    resolve({
                        file: blob,
                        filename: file.name.replace(/\.[^/.]+$/, '') + '.png'
                    });
                }, 'image/png');
            });
        }
        
        async function convertPdfToWord(file) {
            const arrayBuffer = await file.arrayBuffer();
            const loadingTask = pdfjsLib.getDocument(arrayBuffer);
            const pdf = await loadingTask.promise;
            
            let text = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const content = await page.getTextContent();
                const strings = content.items.map(item => item.str);
                text += strings.join(' ') + '\n\n';
            }
            
            const { Document, Paragraph, Packer, TextRun } = docx;
            
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun(text)
                            ]
                        })
                    ]
                }]
            });
            
            const docBuffer = await Packer.toBuffer(doc);
            const docBlob = new Blob([docBuffer], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
            
            return {
                file: docBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.docx'
            };
        }
        
        async function convertImageToWord(file) {
            const { Document, Paragraph, Packer, ImageRun } = docx;
            const arrayBuffer = await file.arrayBuffer();
            
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            children: [
                                new ImageRun({
                                    data: arrayBuffer,
                                    transformation: {
                                        width: 400,
                                        height: 300,
                                    },
                                })
                            ]
                        })
                    ]
                }]
            });
            
            const docBuffer = await Packer.toBuffer(doc);
            const docBlob = new Blob([docBuffer], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
            
            return {
                file: docBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.docx'
            };
        }
        
        async function editPdf(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
            
            const pages = pdfDoc.getPages();
            if (pages.length === 0) {
                throw new Error('PDF has no pages');
            }
            
            const firstPage = pages[0];
            
            firstPage.drawText('Edited with Easy File Conversion', {
                x: 50,
                y: firstPage.getHeight() - 50,
                size: 30,
                color: PDFLib.rgb(0.95, 0.1, 0.1),
            });
            
            const pdfBytes = await pdfDoc.save();
            const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
            
            return {
                file: pdfBlob,
                filename: 'edited_' + file.name
            };
        }
        
        async function mergePdfs(files) {
            const pdfDoc = await PDFLib.PDFDocument.create();
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const arrayBuffer = await file.arrayBuffer();
                const donorPdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                
                const pages = await pdfDoc.copyPages(donorPdfDoc, donorPdfDoc.getPageIndices());
                pages.forEach(page => pdfDoc.addPage(page));
            }
            
            const pdfBytes = await pdfDoc.save();
            const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
            
            return {
                file: pdfBlob,
                filename: 'merged_documents.pdf'
            };
        }
        
        async function compressPdf(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
            
            const compressionLevel = document.getElementById('compression-level').value;
            
            const saveOptions = {
                useObjectStreams: true,
            };
            
            switch(compressionLevel) {
                case 'low':
                    saveOptions.useCompression = true;
                    break;
                case 'medium':
                    saveOptions.useCompression = true;
                    saveOptions.keepExistingFields = false;
                    break;
                case 'high':
                    saveOptions.useCompression = true;
                    saveOptions.keepExistingFields = false;
                    saveOptions.keepIndirectObjects = false;
                    break;
            }
            
            const pdfBytes = await pdfDoc.save(saveOptions);
            const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
            
            return {
                file: pdfBlob,
                filename: 'compressed_' + file.name
            };
        }
        
        async function splitPdf(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
            
            const splitMethod = document.getElementById('split-method').value;
            let pageRanges = [];
            
            if (splitMethod === 'range') {
                const rangeText = document.getElementById('page-range').value;
                pageRanges = parsePageRanges(rangeText, pdfDoc.getPageCount());
            } else {
                const everyX = parseInt(document.getElementById('every-pages').value);
                const pageCount = pdfDoc.getPageCount();
                
                for (let i = 0; i < pageCount; i += everyX) {
                    const end = Math.min(i + everyX, pageCount);
                    pageRanges.push({ start: i + 1, end: end });
                }
            }
            
            if (pageRanges.length === 0) {
                throw new Error('No valid page ranges specified');
            }
            
            const JSZip = await loadJSZip();
            const zip = new JSZip();
            
            for (let i = 0; i < pageRanges.length; i++) {
                const range = pageRanges[i];
                const newPdfDoc = await PDFLib.PDFDocument.create();
                
                const pagesToCopy = [];
                for (let j = range.start; j <= range.end; j++) {
                    pagesToCopy.push(j - 1);
                }
                
                const pages = await newPdfDoc.copyPages(pdfDoc, pagesToCopy);
                pages.forEach(page => newPdfDoc.addPage(page));
                
                const pdfBytes = await newPdfDoc.save();
                const fileName = file.name.replace(/\.[^/.]+$/, '') + `_part${i + 1}.pdf`;
                zip.file(fileName, pdfBytes);
            }
            
            const zipBlob = await zip.generateAsync({ type: 'blob' });
            
            return {
                file: zipBlob,
                filename: 'split_' + file.name.replace(/\.[^/.]+$/, '') + '.zip'
            };
        }
        
        function parsePageRanges(rangeText, maxPages) {
            const ranges = [];
            const parts = rangeText.split(',');
            
            for (const part of parts) {
                if (part.includes('-')) {
                    const [start, end] = part.split('-').map(num => parseInt(num.trim()));
                    if (!isNaN(start) && !isNaN(end)) {
                        ranges.push({
                            start: Math.max(1, Math.min(start, maxPages)),
                            end: Math.max(1, Math.min(end, maxPages))
                        });
                    }
                } else {
                    const page = parseInt(part.trim());
                    if (!isNaN(page)) {
                        const validPage = Math.max(1, Math.min(page, maxPages));
                        ranges.push({
                            start: validPage,
                            end: validPage
                        });
                    }
                }
            }
            
            return ranges;
        }
        
        async function repairPdf(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer, { ignoreEncryption: true });
                
                const pdfBytes = await pdfDoc.save();
                const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
                
                return {
                    file: pdfBlob,
                    filename: 'repaired_' + file.name
                };
            } catch (error) {
                throw new Error('Unable to repair the PDF file. It may be too severely damaged.');
            }
        }
        
        async function convertImageToPdf(file) {
            const img = await createImageBitmap(file);
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            
            const pdf = new jsPDF({
                orientation: img.width > img.height ? 'landscape' : 'portrait',
                unit: 'mm'
            });
            
            const imgData = canvas.toDataURL('image/jpeg');
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();
            
            const imgRatio = img.width / img.height;
            const pdfRatio = pdfWidth / pdfHeight;
            
            let width, height;
            if (imgRatio > pdfRatio) {
                width = pdfWidth;
                height = pdfWidth / imgRatio;
            } else {
                height = pdfHeight;
                width = pdfHeight * imgRatio;
            }
            
            pdf.addImage(imgData, 'JPEG', 0, 0, width, height);
            const pdfBlob = pdf.output('blob');
            
            return {
                file: pdfBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.pdf'
            };
        }
        
        async function compressImage(file) {
            const quality = parseInt(document.getElementById('image-quality').value) / 100;
            const width = parseInt(document.getElementById('image-width').value) || undefined;
            const height = parseInt(document.getElementById('image-height').value) || undefined;
            
            return new Promise((resolve) => {
                new Compressor(file, {
                    quality,
                    width,
                    height,
                    success(result) {
                        resolve({
                            file: result,
                            filename: 'compressed_' + file.name
                        });
                    },
                    error(err) {
                        throw new Error('Image compression failed: ' + err.message);
                    }
                });
            });
        }
        
        async function mergeImages(files) {
            const direction = document.getElementById('merge-direction').value;
            const spacing = parseInt(document.getElementById('merge-spacing').value);
            const bgColor = document.getElementById('merge-background').value;
            
            const images = [];
            for (let i = 0; i < files.length; i++) {
                const img = await createImageBitmap(files[i]);
                images.push(img);
            }
            
            let canvasWidth = 0;
            let canvasHeight = 0;
            
            if (direction === 'horizontal') {
                canvasWidth = images.reduce((sum, img) => sum + img.width, 0) + (spacing * (images.length - 1));
                canvasHeight = Math.max(...images.map(img => img.height));
            } else {
                canvasWidth = Math.max(...images.map(img => img.width));
                canvasHeight = images.reduce((sum, img) => sum + img.height, 0) + (spacing * (images.length - 1));
            }
            
            const canvas = document.createElement('canvas');
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = bgColor;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            let x = 0;
            let y = 0;
            
            for (const img of images) {
                ctx.drawImage(img, x, y);
                
                if (direction === 'horizontal') {
                    x += img.width + spacing;
                } else {
                    y += img.height + spacing;
                }
            }
            
            return new Promise((resolve) => {
                canvas.toBlob((blob) => {
                    resolve({
                        file: blob,
                        filename: 'merged_images.png'
                    });
                }, 'image/png');
            });
        }
        
        async function splitImage(file) {
            const img = await createImageBitmap(file);
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            
            const halfWidth = img.width / 2;
            const halfHeight = img.height / 2;
            
            const parts = [
                { x: 0, y: 0, width: halfWidth, height: halfHeight },
                { x: halfWidth, y: 0, width: halfWidth, height: halfHeight },
                { x: 0, y: halfHeight, width: halfWidth, height: halfHeight },
                { x: halfWidth, y: halfHeight, width: halfWidth, height: halfHeight }
            ];
            
            const JSZip = await loadJSZip();
            const zip = new JSZip();
            
            for (let i = 0; i < parts.length; i++) {
                const part = parts[i];
                const partCanvas = document.createElement('canvas');
                partCanvas.width = part.width;
                partCanvas.height = part.height;
                const partCtx = partCanvas.getContext('2d');
                
                partCtx.drawImage(
                    canvas,
                    part.x, part.y, part.width, part.height,
                    0, 0, part.width, part.height
                );
                
                const blob = await new Promise(resolve => 
                    partCanvas.toBlob(resolve, 'image/jpeg', 0.9)
                );
                
                const fileName = file.name.replace(/\.[^/.]+$/, '') + `_part${i + 1}.jpg`;
                zip.file(fileName, blob);
            }
            
            const zipBlob = await zip.generateAsync({ type: 'blob' });
            
            return {
                file: zipBlob,
                filename: 'split_' + file.name.replace(/\.[^/.]+$/, '') + '.zip'
            };
        }
        
        async function convertWordToPpt(file) {
            const arrayBuffer = await file.arrayBuffer();
            const result = await mammoth.convertToHtml({ arrayBuffer });
            
            const PptxGenJS = await loadPptxGenJS();
            const pptx = new PptxGenJS();
            
            const slide = pptx.addSlide();
            slide.addText(result.value, { x: 0.5, y: 0.5, w: 9, h: 6.5, fontSize: 18 });
            
            const pptBuffer = await pptx.write({ outputType: 'arraybuffer' });
            const pptBlob = new Blob([pptBuffer], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' });
            
            return {
                file: pptBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.pptx'
            };
        }
        
        async function convertPptToWord(file) {
            const { Document, Paragraph, Packer, TextRun } = docx;
            
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            children: [
                                new TextRun('PPT content would be extracted here. In a real implementation, you would use a library to extract text from PowerPoint slides.')
                            ]
                        })
                    ]
                }]
            });
            
            const docBuffer = await Packer.toBuffer(doc);
            const docBlob = new Blob([docBuffer], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
            
            return {
                file: docBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.docx'
            };
        }
        
        async function convertPptToPdf(file) {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            pdf.text('PPT slides would be converted to PDF here. In a real implementation, you would use a library to convert PowerPoint slides to PDF.', 10, 10);
            
            const pdfBlob = pdf.output('blob');
            return {
                file: pdfBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.pdf'
            };
        }
        
        async function convertPdfToPpt(file) {
            const PptxGenJS = await loadPptxGenJS();
            const pptx = new PptxGenJS();
            
            const slide = pptx.addSlide();
            slide.addText('PDF pages would be converted to PPT slides here. In a real implementation, you would use a library to convert PDF pages to images and add them as slides.', { x: 0.5, y: 0.5, w: 9, h: 6.5, fontSize: 18 });
            
            const pptBuffer = await pptx.write({ outputType: 'arraybuffer' });
            const pptBlob = new Blob([pptBuffer], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' });
            
            return {
                file: pptBlob,
                filename: file.name.replace(/\.[^/.]+$/, '') + '.pptx'
            };
        }
        
        // Helper function to dynamically load JSZip
        function loadJSZip() {
            return new Promise((resolve) => {
                if (window.JSZip) {
                    resolve(window.JSZip);
                } else {
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js';
                    script.onload = () => resolve(window.JSZip);
                    document.head.appendChild(script);
                }
            });
        }
        
        // Helper function to dynamically load pptxgenjs
        function loadPptxGenJS() {
            return new Promise((resolve) => {
                if (window.PptxGenJS) {
                    resolve(window.PptxGenJS);
                } else {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/pptxgenjs@3.7.0/dist/pptxgen.bundle.js';
                    script.onload = () => resolve(window.PptxGenJS);
                    document.head.appendChild(script);
                }
            });
        }
    </script>
</body>
</html>
